---
title: "Performing a schema extraction"


legacyRedirectsGenerated:
  # This list is generated by a script. If you need add entries, use the `legacyRedirects` key.
  - "/edb-docs/d/edb-postgres-migration-portal/user-guides/user-guide/3.0.1/mp_schema_extraction.html"
---

<div id="mp_schema_extraction" class="registered_link"></div>

# Extracting Schema
This section guides you through the steps to use the Oracle’s Data Pump utility to extract Oracle schemas to a SQL dump file. You can extract metadata and data for a complete database or subsets of a database. However, Migration Portal only requires the metadata information in the SQL dump file to assess the extracted schemas.

Note that Oracle Data Pump’s command-line clients expdp and impdp use the procedures provided in the DBMS_DATAPUMP PL/SQL package.

### Prerequisites

* If you plan on exporting schemas that are not your own, ensure that you are assigned the *DATAPUMP_IMP_FULL_DATABASE* role. Otherwise, you can only export your own schema.

* Ensure that you have a sufficient tablespace quota to create objects in the tablespace.

## Extract one or more schemas to an SQL dump file

The Data Pump utility can be run from SQL*Plus, as follows:

1. Create a directory object that points to a directory on your server file system. For example:
 **On Linux**:
 `SQL> create directory DMPDIR as '/sample/file/path';`
 **On Windows**:
 `SQL> create directory DMPDIR as 'c:\sample\file\path\';`

2. Grant read, write permissions to the user running the Data Pump utility.
`SQL> grant read,write on directory DMPDIR to <Username>;`

3. Before running the export command, create a parameter file with a *.par* extension and add the following attributes and values:
  
   + `CONTENT=metadata_only`: Extracts only the metadata of the schemas.  
   + `INCLUDE`: Specifies which database object types to include. Use this list to ensure that the Data Pump utility only extracts database object types supported by the Migration Portal.
   + `EXCLUDE`: Specifies which schemas to exclude. Use this list to ensure that the Data Pump utility *does not* extract Oracle system schemas which are not supported by the Migration Portal.
 
   **Note**: (Optional) To extract all schemas in the database, you can enter `FULL=Y` in the par file.
   
   In this example, we create a parameters.par file with the following content:

   ```
   $ cat parameters.par

   CONTENT=metadata_only

   INCLUDE=SYNONYM,SEQUENCE,TYPE,TABLE,CONSTRAINT,PROCEDURE,FUNCTION,PACKAGE,INDEX,MATERIALIZED_VIEW,VIEW,TRIGGER,DB_LINK	
 
   EXCLUDE=SCHEMA:"IN(select username as schema_name from sys.dba_users where LOWER(username) LIKE 'pg_%' OR username IN
   ('ANONYMOUS','APEX_PUBLIC_USER','APEX_030200','APEX_040000','APEX_040200','APPQOSSYS','AUDSYS','CTXSYS','DMSYS','DBSNMP',
   'DBSFWUSER','DEMO','DIP','DMSYS', 'DVF','DVSYS','EXFSYS','FLOWS_FILES','FLOWS_020100', 'FRANCK','GGSYS','GSMADMIN_INTERNAL',
   'GSMCATUSER','GSMROOTUSER','GSMUSER','LBACSYS','MDDATA','MDSYS','MGMT_VIEW','OJVMSYS','OLAPSYS','ORDPLUGINS','ORDSYS',
   'ORDDATA','OUTLN','ORACLE_OCM','OWBSYS','OWBYSS_AUDIT','PDBADMIN','RMAN','REMOTE_SCHEDULER_AGENT','SI_INFORMTN_SCHEMA',
   'SPATIAL_CSW_ADMIN_USR','SPATIAL_WFS_ADMIN_USR','SQLTXADMIN','SQLTXPLAIN','SYS$UMF','SYS','SYSBACKUP','SYSDG','SYSKM',
   'SYSRAC','SYSTEM','SYSMAN','TSMSYS','WKPROXY','WKSYS','WK_TEST','WMSYS','XDB','XS$NULL'))"
   ```

4. Next, run the export command to generate a db.dump file with metadata. For example, to extract Schema1, Schema2, and Schema3 schemas to a db.dump file, run the following command:
 
   ```
   $ expdp <Username>@<ConnectIdentifier> DIRECTORY=DMPDIR SCHEMAS=Schema1,Schema2,Schema3 DUMPFILE=db.dump parfile=parameters.par
   ```
   **Note**: If you have specified `FULL=Y` in your .par file, you must run the command without the schemas parameter, as follows:
 
    `expdp <Username>@<ConnectIdentifier> DIRECTORY=DMPDIR DUMPFILE=db.dump parfile=parameters.par`

5. To generate a SQL file from the dump file, run the import command. 

   For example, to generate YourSchemas.SQL file from the db.dump file, enter the following command:
 
   `$ impdp <Username>@<ConnectIdentifier> DIRECTORY=<directory_name> TRANSFORM=OID:n SQLFILE=YourSchemas.sql DUMPFILE=db.dump`


**Note**: Migration Portal might become unresponsive for large SQL files depending on your system’s and browser’s resource availability. If the SQL file size exceeds 1 GB, you can reduce the SQL file size by splitting the schemas across multiple SQL files and extracting fewer schemas in each SQL file.


## Supported object types

The Migration Portal supports the migration of the following object types:

-   Synonyms
-   DB Links
-   Types and type body
-   Sequences
-   Tables
-   Constraints
-   Indexes (Except LOB indexes and indexes on materialized views)
-   Views
-   Materialized views
-   Triggers
-   Functions
-   Procedures
-   Packages

!!! Note
    COMMENTS on columns, tables, and materialized views are also supported.

## Unsupported object types

-   Editions
-   Operators
-   Schedulers
-   LOB indexes and indexes on materialized views
-   XML schemas
-   Profiles
-   Role and object grants
-   Tablespaces
-   Directories
-   Users
-   RLS policy
-   Queues

## Oracle system schemas

Migration Portal ignores the following Oracle system schemas:

|                       |                       |                    |
| --------------------- | --------------------- | ------------------ |
| ANONYMOUS             | APEX_PUBLIC_USER      | APEX_030200        |
| APEX_040000           | APEX_040000           | APPQOSSYS          |
| AUDSYS                | BI                    | CTXSYS             |
| DMSYS                 | DBSNMP                | DIP                |
| DVF                   | DVSYS                 | EXFSYS             |
| FLOWS_FILES           | FLOWS_020100          | GSMADMIN_INTERNAL  |
| GSMCATUSER            | GSMUSER               | IX                 |
| LBACSYS               | MDDATA                | MDSYS              |
| MGMT_VIEW             | OE                    | OJVMSYS            |
| OLAPSYS               | ORDPLUGINS            | ORDSYS             |
| ORDDATA               | OUTLN                 | ORACLE_OCM         |
| OWBSYS                | OWBYSS_AUDIT          | PM                 |
| RMAN                  | SH                    | SI_INFORMTN_SCHEMA |
| SPATIAL_CSW_ADMIN_USR | SPATIAL_WFS_ADMIN_USR | SYS                |
| SYSBACKUP             | SYSDG                 | SYSKM              |
| SYSTEM SYSMAN         | TSMSYS WKPROXY        | WKSYS              |
| WK_TEST XS$NULL       | WMSYS                 | XDB                |
