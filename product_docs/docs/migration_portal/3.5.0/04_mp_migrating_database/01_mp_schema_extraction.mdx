---
title: "Performing a schema extraction"


legacyRedirectsGenerated:
  # This list is generated by a script. If you need add entries, use the `legacyRedirects` key.
  - "/edb-docs/d/edb-postgres-migration-portal/user-guides/user-guide/3.0.1/mp_schema_extraction.html"
---

<div id="mp_schema_extraction" class="registered_link"></div>

You can use the Data Pump (DBMS_DATAPUMP) PL/SQL package to extract metadata and data from your Oracle database to an SQL dump file.

!!! Note
    If the SQL file size exceeds 1 GB, you can reduce the SQL file size by splitting the schemas across multiple SQL files and extracting fewer schemas in each SQL file. Migration Portal might become unresponsive for large SQL files depending on your system’s and browser’s resource availability.

## Extract one or more schemas to an SQL dump file

Note that Migration Portal only requires the metadata in the SQL dump file to assess the extracted schemas.


#### Prerequisites

* If you plan on exporting schemas that are not your own, ensure that you are assigned the *DATAPUMP_IMP_FULL_DATABASE* role. Otherwise, you can only export your own schema.

* Ensure that you have sufficient tablespace quota to create objects in the tablespace.

Perform the following steps:

1. In SQL*Plus, create a directory object that points to a directory on your server file system. For example:
 
 **On Linux**:

 `SQL> create directory DMPDIR as '/sample/file/path';`
 
 **On Windows**:

 `SQL> create directory DMPDIR as 'c:\sample\file\path\';`

2. Grant read, write permissions to the user running the Data Pump utility.

 `SQL> grant read,write on directory DMPDIR to <Username>;`

3. Before running the `expdp` command, create a file with a `.par` extension (for example: parameters.par) on your server. Add attributes and values to the file using the following command: 

   ```
   $ cat parameters.par

   CONTENT=metadata_only

   INCLUDE=SYNONYM,SEQUENCE,TYPE,TABLE,CONSTRAINT,PROCEDURE,FUNCTION,PACKAGE,INDEX,MATERIALIZED_VIEW,VIEW,TRIGGER,DB_LINK	
 
   EXCLUDE=SCHEMA:"IN(select username as schema_name from sys.dba_users where LOWER(username) LIKE 'pg_%' OR username IN
   ('ANONYMOUS','APEX_PUBLIC_USER','APEX_030200','APEX_040000','APEX_040200','APPQOSSYS','AUDSYS','CTXSYS','DMSYS','DBSNMP',
   'DBSFWUSER','DEMO','DIP','DMSYS', 'DVF','DVSYS','EXFSYS','FLOWS_FILES','FLOWS_020100', 'FRANCK','GGSYS','GSMADMIN_INTERNAL',
   'GSMCATUSER','GSMROOTUSER','GSMUSER','LBACSYS','MDDATA','MDSYS','MGMT_VIEW','OJVMSYS','OLAPSYS','ORDPLUGINS','ORDSYS',
   'ORDDATA','OUTLN','ORACLE_OCM','OWBSYS','OWBYSS_AUDIT','PDBADMIN','RMAN','REMOTE_SCHEDULER_AGENT','SI_INFORMTN_SCHEMA',
   'SPATIAL_CSW_ADMIN_USR','SPATIAL_WFS_ADMIN_USR','SQLTXADMIN','SQLTXPLAIN','SYS$UMF','SYS','SYSBACKUP','SYSDG','SYSKM',
   'SYSRAC','SYSTEM','SYSMAN','TSMSYS','WKPROXY','WKSYS','WK_TEST','WMSYS','XDB','XS$NULL'))"
   ```
The attributes and values in the above command specify the following options:  
   + `CONTENT=metadata_only` extracts only the metadata of the schemas.  
   + `INCLUDE=` specifies which database object types to include in the extraction. Append a comma-separated list of the [Supported object types](#supported-object-types) to only extract database object types that are supported by Migration Portal.
   + `EXCLUDE=SCHEMA:` specifies which schemas to exclude in the extraction. Append a list of the [Unsupported schemas](#unsupported-schemas) to ensure that the Data Pump utility *does not* extract any system schemas (including schemas beginning with **pg_**). 

   !!! Tip
   
   (Optional) Oracle Data Pump utility allows you to extract all schemas in the database. To extract metadata for *all* schemas, enter `FULL=Y` in the .par file.

4. From the command line, run the export command to generate a **db.dump** file. For example, to extract metadata information for `<Schema_1>`, `<Schema_2>`, `<Schema_3>`, and so on, run the following command:
 
   ```
   $ expdp <Username>@<ConnectIdentifier> DIRECTORY=DMPDIR SCHEMAS=<Schema_1>,<Schema_2>,<Schema_3> DUMPFILE=db.dump parfile=parameters.par
   ```
   Alternatively, If you have specified `FULL=Y` in your `.par` file and want to extract all schemas, you must run the command as follows:
 
    ```
    $ expdp <Username>@<ConnectIdentifier> DIRECTORY=DMPDIR DUMPFILE=db.dump parfile=parameters.par
    ```

5. To generate a SQL file from the dump file, run the import command. 

   For example, to generate **YourSchemas.SQL** file from the db.dump file, enter the following command:
 
   ```
    $ impdp <Username>@<ConnectIdentifier> DIRECTORY=<directory_name> TRANSFORM=OID:n SQLFILE=YourSchemas.sql DUMPFILE=db.dump
   ```


## Extracted schemas and objects

See the following sections for supported and unsupported schemas and objects.

### Unsupported schemas

See the following table for a list of Oracle systems schemas you must exclude while generating the SQL dump file.

|                       |                     |                   |                    |                         |
| :-------------------- | :------------------ | :---------------- | :----------------- | :---------------------- |
| ANONYMOUS             | APEX_PUBLIC_USER    | APEX_030200       | APEX_040000        | APEX_040200             |
| APPQOSSYS             | AUDSYS              | BI                | CTXSYS             | DMSYS                   |
| DBSNMP                | DIP                 | DVF               | DVSYS              | EXFSYS                  |
| FLOWS_FILES           | FLOWS_020100        | GSMADMIN_INTERNAL | GSMCATUSER         | GSMUSER                 |
| IX                    | LBACSYS             | MDDATA            | MDSYS              | MGMT_VIEW               |
| OE                    | OJVMSYS             | OLAPSYS           | ORDPLUGINS         | ORDSYS                  |
| ORDDATA               | OUTLN               | ORACLE_OCM        | OWBSYS             | OWBYSS_AUDIT            |
| PM                    | RMAN                | SH                | SI_INFORMTN_SCHEMA | SPATIAL_CSW_ADMIN_USR   |
| SPATIAL_WFS_ADMIN_USR | SYS                 | SYSBACKUP         | SYSDG              | SYSKM                   |
| SYSTEM                | SYSMAN              | TSMSYS            | WKPROXY            | WKSYS                   |
| WK_TEST               | WMSYS               | XDB               | XS$NULL            |	                     |

!!! Note
    EDB Postgres Advanced Server does not support schema names starting with **pg_**, which should also be excluded while extracting from Oracle.

### Supported object types

The Migration Portal supports the migration of the following object types:

-   Synonyms
-   DB Links
-   Types and type body
-   Sequences
-   Tables
-   Constraints
-   Indexes (Except LOB indexes and indexes on materialized views)
-   Views
-   Materialized views
-   Triggers
-   Functions
-   Procedures
-   Packages

!!! Note
    COMMENTS on columns, tables, and materialized views are also supported.

### Unsupported object types

-   Editions
-   Operators
-   Schedulers
-   LOB indexes and indexes on materialized views
-   XML schemas
-   Profiles
-   Role and object grants
-   Tablespaces
-   Directories
-   Users
-   RLS policy
-   Queues