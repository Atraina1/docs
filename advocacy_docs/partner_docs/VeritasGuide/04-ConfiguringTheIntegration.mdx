---
title: 'Configuring the Integration'
description: 'Walkthrough on configuring Veritas NetBackup for PostgreSQL'
---

**Implementing Veritas NetBackup solution for backup/restore of PostgreSQL databases requires the following components:**

- EDB Postgres Advanced Server (EPAS).
- Veritas NetBackup Server.
- Veritas NetBackup Client.
- Veritas NetBackup Agent for PostgreSQL.

### Prerequisites

- A running EDB Postgres Advanced Server (EPAS).
- A running Veritas NetBackup Server with a DataStore Policy set up.
- Veritas NetBackup Client installed on the EPAS host.
- Veritas NetBackup PostgreSQL Agent installed on the EPAS host.


Configuring Veritas NetBackup for PostgreSQL consists of configuring the following components:
- Veritas NetBackup Agent for PostgreSQL.
- PostgreSQL server.

The steps below show an example of how to configure Veritas NetBackup for PostgreSQL for EPAS version 13.

#### Configuring Veritas NetBackup Agent for PostgreSQL

1. Log on to the NetBackup Administration Console using the credentials for the **root** user and selecting the hostname for the NetBackup Master Server you want to administer:

<p align="center">
    <img  src="Images/NetBackupAdminConsole.png">
</p>

2. Within the Admin Console, click **NetBackup Management > Policies** and verify a policy of the type **DataStore** exists:

<p align="center">
    <img  src="Images/NetBackupDataPolicy.png">
</p>

Refer to the [Veritas NetBackup Administrator's Guide](https://www.veritas.com/content/support/en_US/doc/18716246-126559472-0/v42176014-126559472) for detailed information on policies.

3.  On the NetBackup Client, update the agent configuration file `/usr/NBPostgreSQLAgent/nbpgsql.conf` to set the necessary parameters to make the agent work successfully with EPAS:
    ```
    DB_USER= enterprisedb
    DB_PORT=5444
    DB_INSTANCE_NAME=edb
    PGSQL_LIB_INSTALL_PATH= /usr/edb/as13/lib
    MASTER_SERVER_NAME=<netbackup-master-server>
    POLICY_NAME=<datastore-policy>
    SCHEDULE_NAME= Default-Application-Backup
    SNAPSHOT_SIZE=4MB
    ```

!!! Note
    Values of **MASTER_SERVER_NAME** and **POLICY_NAME** parameters must match the names of your NetBackup Master Server and DataStore Policy respectively.

In the sample configuration file above, the values for **DB_USER**, **DB_PORT**, **DB_INSTANCE_NAME**, and **PGSQL_LIB_INSTALL_PATH** have been substituted for EPAS as the default values are for Postgres.
Refer to the [Veritas NetBackup for PostgreSQL Administrator's Guide](https://www.veritas.com/content/support/en_US/doc/129277259-150015228-0/v129276458-150015228) for detailed description of the parameters.



#### Configuring EPAS

Set up WAL archiving on the EPAS server by using the steps below. WAL archiving prepares Postgresql/EPAS database servers for backup/recovery operations and must be set up in order for any backup/recovery tool to work with the database server.

1.	Create the <archivedir> directory at your desired location.

2.	Set the required parameters in the postgresql.conf file to turn on WAL archiving:
    ```
    wal_level = archive
    archive_mode = on
    archive_timeout = 0
    statement_timeout = 0
    archive_command = test ! -f <archivedir>/%f && cp %p <archivedir>/%f
    ```

!!! Note
    Value of <archivedir> must match the location of the directory created in Step 1.

3.	Restart the PostgreSQL server.

Refer to the [Veritas NetBackup for PostgreSQL Administrator's Guide](https://www.veritas.com/content/support/en_US/doc/129277259-150015228-0/v129903049-150015228) for detailed information on how to configure EPAS for Veritas NetBackup Agent for PostgreSQL.

